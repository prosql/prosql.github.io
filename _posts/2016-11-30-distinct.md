---
layout: post
title: Как выбрать строку с максимальной датой
---

Есть следующая таблица:

	id | usr | action | datetime
	____________________________________
	1 | Иванов |  создал  |   datetime1
	2 | Иванов  |  изменил |   datetime2
	3 | Петров |  изменил |   datetime3
	4 | Петров  |  изменил |   datetime4
	5 | Петров  |  изменил |   datetime5
	6 | Сидоров |  изменил |   datetime6
	7 | Сидоров |  Подписал |   datetime7

Необходимо получить информацию последних действиях. кто и когда последний раз создал, изменил и подписал. То есть на выходе должно быть:

	1 | Иванов | создал | datetime1
	6 | Сидоров | изменил | datetime6
	7 | Сидоров | Подписал | datetime7

Нужно выбрать макс дату(строку с макс датой) и остальные поля данной строки.

#### Решение для PostgreSQL

	select distinct on (1) 
		-- выбрать только уникальные значения по первому полю (action) из выборки
	action, 
	usr,
	datetime
		-- вывести action, usr, datetime
	from table t1
	order by 1, datetime desc 
		-- для выборки отсортировать по первому полю (action), затем по дате в обратном порядке

[Обсуждение на Тостере](https://toster.ru/q/375356)
